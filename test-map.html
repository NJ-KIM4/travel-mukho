<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>카카오맵 테스트</title>
  <style>
    body { margin: 0; background: #1e293b; color: white; font-family: sans-serif; }
    #map { width: 100%; height: 70vh; }
    #log { padding: 16px; font-size: 13px; line-height: 1.8; white-space: pre-wrap; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="log">로그 시작...\n</div>

  <script>
    const log = (msg) => {
      document.getElementById('log').textContent += msg + '\n';
      console.log(msg);
    };

    log('1. 스크립트 동적 로드 시작');

    const script = document.createElement('script');
    script.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=1445ee64e0222628060d216742e4284e&autoload=false';

    script.onload = () => {
      log('2. SDK 스크립트 로드 성공! kakao=' + typeof kakao);

      kakao.maps.load(() => {
        log('3. kakao.maps.load() 콜백 실행됨');

        try {
          const container = document.getElementById('map');
          log('4. 컨테이너 크기: ' + container.offsetWidth + 'x' + container.offsetHeight);

          const map = new kakao.maps.Map(container, {
            center: new kakao.maps.LatLng(37.54, 129.11),
            level: 9
          });

          log('5. 지도 생성 성공!');

          const marker = new kakao.maps.Marker({
            position: new kakao.maps.LatLng(37.5475, 129.1142),
            map: map
          });
          log('6. 마커 추가 완료 (묵호등대)');

        } catch (e) {
          log('오류: ' + e.message);
        }
      });
    };

    script.onerror = (e) => {
      log('SDK 로드 실패! 네트워크 또는 API 키 문제');
      log('URL: ' + script.src);
    };

    document.head.appendChild(script);
    log('1-1. script 태그 추가 완료, 로드 대기 중...');
  </script>
</body>
</html>
